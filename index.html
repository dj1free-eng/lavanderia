<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#111827" />
  <title>Lavandería · Parte Diario</title>
  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./css/style.css" />
</head>
<body>
  <!-- HOME / PORTADA -->
  <section id="homeScreen" class="home">
    <div class="home-card">
      <img class="home-logo" src="./assets/hotel-logo.png" alt="Hotel" />
      <div class="home-title">Lavandería</div>
      <div class="home-sub">Parte diario</div>

      <div class="home-date">
        <label class="label">Fecha del parte</label>
        <input id="fechaBase" type="date" />
      </div>

      <button id="btnStart" class="btn btn-primary btn-big">Empezar</button>

      <div class="home-mini">
        <span id="netBadge" class="badge badge-muted">—</span>
        <span id="queueBadge" class="badge badge-muted">Cola: 0</span>
      </div>
    </div>
  </section>

  <!-- APP -->
  <section id="appScreen" class="app hidden">
    <header class="appbar">
      <div class="appbar-left">
        <div class="appbar-title">Lavandería</div>
        <div class="appbar-date" id="uiFechaBase">—</div>
      </div>
      <button id="btnGoHome" class="btn btn-outline btn-small">Cambiar fecha</button>
    </header>

    <main class="main">
      <!-- TAB: SUCIO -->
      <section class="tab" data-tab="sucio">
        <section class="card">
          <div class="card-head">
  <div>
    <div class="card-title">Ropa sucia (jaulas)</div>
    <div class="card-subtitle">Rellena el formulario y añade. Se limpia para la siguiente jaula.</div>
  </div>
</div>

<!-- Formulario único -->
<div class="grid2">
  <div class="row">
    <label class="label">Nº jaula</label>
    <input id="jNumJaula" type="text" placeholder="Ej: 12A" />
  </div>

  <div class="row">
    <label class="label">Categoría</label>
    <select id="jCategoria">
      <option>SÁBANAS</option>
      <option>SERVILLETAS</option>
      <option>CAMINOS</option>
      <option>MANTELES</option>
    </select>
  </div>

  <div class="row">
    <label class="label">Peso bruto (kg)</label>
    <input id="jBruto" type="number" step="0.1" inputmode="decimal" placeholder="Ej: 196.2" />
  </div>

  <div class="row">
    <label class="label">Tara (kg)</label>
    <div style="display:flex; gap:10px;">
      <input id="jTara" type="number" step="0.1" inputmode="decimal" value="42" />
      <button id="btnTara42" class="btn btn-outline" type="button">42</button>
    </div>
  </div>
</div>

<div class="mini" style="margin-top:10px;">
  <strong>Neto:</strong> <span id="jNetoPreview">0,0 kg</span>
</div>

<div class="actions" style="margin-top:12px;">
  <button id="btnAddJaula" class="btn btn-primary">Añadir jaula</button>
</div>

<!-- Lista resumen -->
<div id="jaulasList" class="list"></div>

<div class="totals">
  <div class="tot">
    <div class="tot-label">Sábanas</div>
    <div class="tot-val" id="totSab">0,0 kg</div>
  </div>
  <div class="tot">
    <div class="tot-label">Mantelería</div>
    <div class="tot-val" id="totMant">0,0 kg</div>
  </div>
  <div class="tot tot-main">
    <div class="tot-label">Total sucio</div>
    <div class="tot-val" id="totSuci">0,0 kg</div>
  </div>
</div>
        </section>
      </section>

      <!-- TAB: LIMPIO -->
      <section class="tab hidden" data-tab="limpio">
        <section class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Ropa limpia (tickets)</div>
              <div class="card-subtitle">Unidades por producto según ticket</div>
            </div>
            <button id="btnAddTicket" class="btn btn-outline">+ Ticket</button>
          </div>

          <div id="ticketsList" class="list"></div>
          <hr class="sep" />

<div class="row">
  <label class="label">Ropa extra (bolsas) · kg netos</label>
  <input id="extraKg" type="number" step="0.1" inputmode="decimal" placeholder="0,0" />
  <div class="hint">Se pesa cuando llega limpia separada en bolsas (normalmente fecha +2).</div>
</div>
        </section>
      </section>

      <!-- TAB: HOTEL -->
      <section class="tab hidden" data-tab="hotel">
        <section class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Lavadoras hotel</div>
              <div class="card-subtitle">Conteo por tamaño y tipo</div>
            </div>
          </div>

          <div class="lav-grid">
            <div class="lav-block">
              <div class="lav-title">Blanca</div>
              <div class="lav lav-box" data-tipo="BLANCA"></div>
              <div class="lav-mini">Total: <strong id="kgBlanca">0 kg</strong></div>
            </div>

            <div class="lav-block">
              <div class="lav-title">Piscina</div>
              <div class="lav lav-box" data-tipo="PISCINA"></div>
              <div class="lav-mini">Total: <strong id="kgPiscina">0 kg</strong></div>
            </div>

            <div class="lav-block">
              <div class="lav-title">Varios</div>
              <div class="lav lav-box" data-tipo="VARIOS"></div>
              <div class="lav-mini">Total: <strong id="kgVarios">0 kg</strong></div>
            </div>
          </div>

          <div class="totals">
            <div class="tot tot-main">
              <div class="tot-label">Total hotel</div>
              <div class="tot-val" id="kgHotel">0 kg</div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Toallas piscina</div>
              <div class="card-subtitle">Dobladas, subidas y stock final</div>
            </div>
          </div>

          <div class="grid3">
            <div class="row">
              <label class="label">Dobladas</label>
              <input id="pDob" type="number" step="1" inputmode="numeric" placeholder="0" />
            </div>
            <div class="row">
              <label class="label">Subidas</label>
              <input id="pSub" type="number" step="1" inputmode="numeric" placeholder="0" />
            </div>
            <div class="row">
              <label class="label">Stock</label>
              <input id="pSto" type="number" step="1" inputmode="numeric" placeholder="0" />
            </div>
          </div>
        </section>
      </section>

      <!-- TAB: AJUSTES -->
      <section class="tab hidden" data-tab="ajustes">
        <section class="card">
          <div class="card-head">
            <div>
              <div class="card-title">Ajustes</div>
              <div class="card-subtitle">URL del Script + token (se guardan en este dispositivo)</div>
            </div>
          </div>

          <div class="row">
            <label class="label">Apps Script URL (Web App)</label>
            <input id="cfgUrl" type="url" placeholder="https://script.google.com/macros/s/XXXXX/exec" />
          </div>
          <div class="row">
            <label class="label">Token</label>
            <input id="cfgToken" type="password" placeholder="Tu token secreto" />
          </div>

          <!-- Panel estado + historial (lo que ya añadimos antes) -->
          <div class="status-panel" id="statusPanel">
            <div class="status-row">
              <span class="status-label">Estado</span>
              <span class="status-badge" id="uiNet">—</span>
            </div>
            <div class="status-row">
              <span class="status-label">Cola</span>
              <span class="status-badge" id="uiQueue">0</span>
            </div>
            <div class="status-row">
              <span class="status-label">Último envío</span>
              <span class="status-badge" id="uiLastSent">—</span>
            </div>
            <div class="status-row">
              <span class="status-label">Verificación</span>
              <span class="status-badge" id="uiVerify">—</span>
            </div>
            <div class="status-actions">
              <button id="btnMarkVerified" class="btn btn-outline">Marcar como verificado</button>
            </div>
          </div>

          <div class="history" id="historyCard">
            <div class="history-head">
              <div class="history-title">Historial de hoy (cola)</div>
              <button id="btnRefreshHistory" class="btn btn-outline">Actualizar</button>
            </div>
            <div id="historyList" class="history-list"></div>
          </div>

          <div class="actions">
            <button id="btnSaveCfg" class="btn btn-outline">Guardar ajustes</button>
            <button id="btnExport" class="btn btn-outline">Exportar cola (JSON)</button>
            <button id="btnClear" class="btn btn-danger">Vaciar cola (cuidado)</button>
          </div>

          <pre id="log" class="log" aria-live="polite"></pre>
        </section>
      </section>
    </main>

    <!-- NAV TABS -->
    <nav class="tabs">
      <button class="tabbtn active" data-go="sucio">SUCIO</button>
      <button class="tabbtn" data-go="limpio">LIMPIO</button>
      <button class="tabbtn" data-go="hotel">HOTEL</button>
      <button class="tabbtn" data-go="ajustes">AJUSTES</button>
    </nav>

    <div class="fabbar">
      <button id="btnGuardarParte" class="btn btn-primary btn-wide">Guardar parte offline</button>
      <button id="btnSync" class="btn btn-outline btn-wide">Sincronizar</button>
    </div>
  </section>

  <script type="module" src="./js/app.js"></script>
</body>
</html>
